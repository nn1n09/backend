https://www.notion.so/2e9853a92e63808190f0d8560f3d41b3?source=copy_link
롤체

backend : 김지아
rag : 권기범

선정이유
: 롤체를 처음 접하면 시너지, 아이템, 기물 이라는 어려운 단어로 게임에 어려움을 느낀다. 그래서 많은 초보 롤체 유저들이 롤체 유튜버들을 보며 따라하는 일이 많아졌다. 그렇기에 따라하지만 말고 현재 자신의 게임 상태에 따른 게임 운영을 맛있게 하기 위해 선정하게되었습니다.

전처리 과정

- 목적
    - 영상에 구어체 표현 많음
    - 잡담이 많이 섞여 있음
    - 시간 순서 중심으로 설명
- 흐름
유튜브 영상
↓
자막 추출
↓
텍스트 정제
↓
전략 단위 분리
↓
Chunking
↓
메타데이터 부착
- 자막 추출
- 유튜브 자동 생성 자막 사용
- 자막이 없는 경우 STT모델 확장 가능
- 텍스트 정제
    - 잡담 제거
    - 의미 없는 시간 표현 제거
- 전략 단위 분리
    - 분리 기준
    -게임 진행 단계
        - 전략 유형
- Chunking 전략
    - 300 ~ 500 토큰
    - Overlap 50~100 토큰
- 메타데이터 부착
    - 시즌
    - 패치 버전
    - 조합명
    - 전략 단계
    - 영상 출처?(일단 저작권 고려)
- ai model
    - 클로드 코드(api = 추후 입력)
 
# RAG

## 1️⃣ 데이터 관점에서 RAG가 할 일 (가장 중요)

### 1. 전략 단위 정의

**RAG의 핵심 책임**

- “어디까지가 하나의 전략인가?”를 정의

**예시**

- ❌ 전체 영상 요약
- ❌ 10초 단위 자막
- ✅ “2-1 운영”, “연패 전환 타이밍”, “리롤 판단 기준”

👉 이 기준이 RAG 품질 80%를 좌우

---

### 2. Chunking 설계

이미 잘 적어주셨는데, **RAG 담당이 구체화해야 할 부분**

**권장**

- 300~500 tokens
- overlap 50~100 tokens
- 전략 단위 기준으로 chunk 생성

**주의**

- 서로 다른 전략이 하나의 chunk에 섞이면 검색 망함
- “초반 + 중반” 같이 범위 넓은 chunk 피하기

---

## 2️⃣ 메타데이터 설계 (RAG 담당 핵심)

### 3. 메타데이터 스키마 정의

백엔드는 “저장”, RAG는 **“어떻게 써먹을지”를 정의**

**필수**

- 시즌
- 패치 버전
- 게임 단계 (2-1 / 3-2 / 4-1 등)
- 전략 유형
    - 리롤
    - 레벨업
    - 연승 / 연패
    - 전환 / 고정

**있으면 검색 정확도 급상승**

- 초보자 난이도
- 전제 조건 (아이템, 기물, 골드)

---

### 4. 메타데이터 기반 필터 전략

**RAG가 정해야 할 것**

- 어떤 질문에 어떤 필터를 자동 적용할지

**예시**

| 질문 | 적용 필터 |
| --- | --- |
| “3-2인데 뭐 해야 해요?” | stage=3-2 |
| “연패 중인데 운영?” | strategy=연패 |
| “이 조합 리롤해도 됨?” | comp + 리롤 |

---

## 3️⃣ 검색(Retrieval) 설계

### 5. Hybrid Retrieval 전략

> 벡터 검색만 쓰면 롤체에서는 한계 큼
> 

**권장**

- 벡터 검색 + 메타데이터 필터
- 필요하면 키워드(BM25) 혼합

**예시 흐름**

1. 질문 임베딩
2. stage / patch 필터링
3. 전략 유형 우선 검색
4. Top-k 전략 반환

---

### 6. Top-k & 재정렬(Reranking)

**RAG 담당 결정 사항**

- k = 3? 5?
- 최신 패치 가중치
- 전략 명확도 점수

👉 “비슷하지만 지금 상황엔 애매한 전략” 제거

---

## 4️⃣ 생성(Generation) 설계

### 7. 프롬프트 템플릿 설계 ⭐

RAG 담당의 꽃

**포함 요소**

- 유저 질문
- 현재 게임 상태
- 검색된 전략 chunk
- 말투 가이드 (초보 친화)

**예시 역할 지시**

```
너는 롤체 코치다.
아래 전략만 사용해서 답변해라.
모르면 모른다고 말해라.

```

---

### 8. 환각 방지 규칙

- 컨텍스트에 없는 전략 생성 금지
- “영상에 없는 정보” 금지
- 불확실하면 조건부 답변

---

## 5️⃣ 평가 & 개선 (고급)

### 9. RAG 품질 평가

- 질문 → 답변 → 사용된 chunk 확인
- 잘못된 chunk 검색 시 원인 분석
    - chunk 너무 큼?
    - 메타데이터 부족?

---

### 10. 패치 대응 전략

- 패치 변경 시
    - 이전 chunk 비활성화
    - 최신 전략 우선 검색
- “구버전 전략입니다” 경고 문구




# backend

## 1️⃣ 핵심 백엔드 기능 (필수)

### 1. 데이터 수집 & 전처리 파이프라인

> 이미 전처리 설계를 잘 해두셔서, 이를 자동화하는 백엔드 기능이 중요합니다.
> 

**기능**

- 유튜브 영상 ID 입력 → 자막 자동 수집
- 자막 없는 경우 STT 모델 호출 (옵션)
- 전처리 파이프라인 실행
    - 잡담 제거
    - 시간 표현 제거
    - 전략 단위 분리
    - Chunking
    - 메타데이터 부착
- 결과를 DB + Vector DB에 저장

**백엔드 관점**

- 비동기 작업 큐 (Celery, BullMQ 등)
- 파이프라인 상태 관리 (대기 / 처리중 / 완료 / 실패)

👉 *김지아 백엔드 역할에서 핵심 기여 포인트*

---

### 2. 전략 데이터 관리 API

**기능**

- 전략 Chunk 조회 API
- 메타데이터 기반 필터링
    - 시즌 / 패치
    - 조합명
    - 게임 단계 (초반·중반·후반)
- 영상 출처 관리 (저작권 고려)

**예시**

```json
GET /strategies?patch=14.2&stage=mid&comp=빌지워터

```

---

### 3. RAG 질의 응답 API

**기능**

- 사용자 질문 입력
- Vector DB 검색
- 관련 Chunk Top-k 추출
- LLM에 컨텍스트 전달
- “현재 상황에 맞는 운영 설명” 생성

**질문 예시**

- “2-1에 이 판이면 뭐 해야 돼?”
- “지금 연패 중인데 리롤해야 하나요?”

👉 RAG 품질은 **Chunk 분리 + 메타데이터 필터링**이 좌우합니다.

---

## 2️⃣ 게임 상태 기반 기능 (차별화 포인트)

### 4. 게임 상태 입력 API ⭐

> “따라하기 말고, 내 게임 기준 운영”이라는 선정 이유와 직결
> 

**입력 데이터 예시**

```json
{
"stage":"3-2",
"gold":32,
"hp":68,
"board_units":["아리2","니달리1"],
"items":["BF","Chain"],
"synergies":["비술사2"],
"win_streak":false
}

```

**백엔드 역할**

- 게임 상태 → 구조화
- 전략 검색 시 메타데이터 필터로 활용
- RAG 프롬프트에 반영

---

### 5. 전략 필터링 로직

**기능**

- 현재 게임 단계와 맞지 않는 전략 제거
- 패치 불일치 전략 제외
- “연승/연패”, “리롤/레벨업” 전략 분리

👉 단순 벡터 검색보다 **Rule + RAG 혼합**이 좋음

---

## 3️⃣ 고급 백엔드 기능 (완성도 상승)

### 6. 전략 요약 & 압축 API

- 긴 전략 → 한 줄 운영 지침으로 요약
- 초보자 친화 모드 / 고급자 모드 분리

**예시**

> “지금은 리롤 금지, 7렙 찍고 전환 각 보세요”
> 

---

### 7. 패치 버전 관리 시스템

**기능**

- 신규 패치 등록
- 기존 전략의 유효성 상태 변경
    - `valid / outdated / experimental`
- 오래된 전략 자동 제외

👉 롤체 특성상 **패치 대응은 서비스 생존 요소**

---

### 8. 출처 및 저작권 보호 기능

- 원본 영상 링크 저장
- 답변에 “출처 요약” 표시
- Chunk 원문 전체 노출 제한

---

## 4️⃣ 확장 아이디어 (있으면 발표 때 점수↑)

### 9. “지금 뭐 하면 좋음?” 원클릭 API

- 질문 없이
- 게임 상태만 보내면
- 자동 운영 가이드 반환

---

### 10. 전략 신뢰도 스코어

- 사용된 영상 수
- 최신 패치 여부
- 메타 적합도
